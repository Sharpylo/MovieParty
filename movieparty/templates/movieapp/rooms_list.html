{% extends "movieapp/base.html" %}
{% load crispy_forms_filters %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}
<div class="create">
    <a class="create" href="{% url 'room_create' %}">Добавить комнату</a>
</div>
<br>
<div class="row">
    {% if rooms %}
    {% for room in rooms %}
    <div class="col-md-3 col-sm-6 col-12 room-wrapper">
        <p class="room-name">Создал - {{ room.created_by }} </p>
        {% if room.has_password %}
        <a class="room-link" href="{% url 'check_password' room.id %}">{{ room.name }} </a>
        {% else %}
        <a class="room-link" href="{% url 'chat_room_view' room.id %}">{{ room.name }}</a>
        {% endif %}
        <p>Комната создана - {{ room.created_at }}</p>
    </div>

    {% if user.is_authenticated and user == room.created_by %}
    <div class="col-sm-1 p-3 ">
        <div class="btn-group">
            <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown">
                &equiv;
            </button>
            <ul class="dropdown-menu">
                <li><a href="{% url 'room_update' room.id %}" class='dropdown-item'>Изменить</a>
                </li>
                <li><a href="{% url 'room_delete' room.id %}"
                       onclick="return confirm('Вы уверены, что хотите удалить этот элемент?');"
                       class='dropdown-item'>Удалить</a></li>
            </ul>
        </div>
    </div>
    {% endif %}

    {% endfor %}
    {% else %}
    <p class="no_films">Комнат нет.</p>
    {% endif %}
</div>
{% endblock %}